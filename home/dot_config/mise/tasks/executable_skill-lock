#!/usr/bin/env bash
#MISE description="Update skill lock file and sync to chezmoi"
#MISE alias="sl"

set -e

# Generate lock file from installed skills
echo "Generating skill lock file..."
npx skills generate-lock

# Copy to chezmoi source
CHEZMOI_SOURCE=$(chezmoi source-path)
DEST="$CHEZMOI_SOURCE/dot_agents/.skill-lock.json"

if [ -f ~/.agents/.skill-lock.json ]; then
    cp ~/.agents/.skill-lock.json "$DEST"
    echo "Lock file synced to: $DEST"
else
    echo "Error: Lock file not found at ~/.agents/.skill-lock.json"
    exit 1
fi
